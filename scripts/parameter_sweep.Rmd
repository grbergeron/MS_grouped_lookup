---
title: "complexes"
output: html_document
---

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:


```{r eval=FALSE}
install.packages("ggplot2")
install.packages("cowplot")
#install.packages("gdata")
install.packages("dplyr")
install.packages("purrr")
install.packages("stringr")
install.packages("tidyr")
install.packages("reshape2")
install.packages("forcats")
install.packages("ggdendro")

```

```{r}
library(ggplot2)
library(cowplot)
library(plotly)

#require(gdata)
#require(gplots)
#require(reshape2)
#require(plyr)
library(dplyr)
#require(purrr)
#require(stringr)
#require(tidyr)
#library(forcats)
#library(ggdendro)
#library(gdata)

```


Color scheme
```{r message=FALSE, warning=FALSE}

blue<-"#0072B2"
palette <- c("#979797","#009E24","#FF0000", "#0072B2", "#979797","#009E24", "#FFD700", "#E69F00")
#palette <- c(green,gray, red, blue, gray, green, yellow2)

```





```{r}
#df <- read.csv("arathtraesorysjbraolselml_euNOG_concat.csv", sep=",", header=TRUE)
setwd("~/Documents/atobsc4")
getwd()
df <- read.csv("atobsc4_formatted_output_numClust_w_header.csv",sep=",", header=TRUE)


# <- read.csv("arathtraesorysj_euNOG_concat_hiergene_raw.txt", sep="\t", header=TRUE)
```


```{r}

names(df)



#df$selected[df["ii"] == 138] <- TRUE
#df$selected[df["ii"] != 138] <- FALSE

df$clique_precision_recall_product <- df$clique_precision_mean_normalize_weighted * df$clique_recall_mean_normalize_weighted
df$max_product <- df$clique_precision_recall_product * df$precision_recall_product 
head(df)

ggplot(df, aes(x=numClust, y=precision_recall_product, color=density)) +
  geom_point()

ggplot(df, aes(x=numClust, y=precision_recall_product, color=density, label=ii)) +
  geom_point() +
  facet_wrap(~threshold_score)

ggplotly()
2696
2156
ggplot(df, aes(x=numClust, y=clique_precision_recall_product, color=threshold_score, label=ii)) +
  geom_point()


ggplotly()

ggplot(df, aes(x=inflation, y=precision_recall_product, color=threshold_score)) +
  geom_jitter()

ggplot(df, aes(x=inflation, y=clique_precision_recall_product, color=threshold_score)) +
  geom_jitter()


ggplot(df, aes(x=overlap, y=precision_recall_product, color=threshold_score)) +
  geom_jitter()

ggplot(df, aes(x=threshold_score, y=precision_recall_product, color=numClust)) +
  geom_point()
```


```{r}

ggplot(df, aes(x=clique_recall_mean, y=ppv, color=threshold_score)) +
  geom_point()

ggplot(df, aes(x=clique_precision_mean_normalize_weighted, y=precision_recall_product, color=threshold_score)) +
  geom_point()

ggplot(df, aes(x=clique_precision_mean_normalize_weighted, y=clique_recall_mean_normalize_weighted, color =precision_recall_product)) +
  geom_point() +
  scale_size_continuous(limits = c(0.03,0.041))

ggplot(df, aes(x=clique_precision_mean_normalize_weighted, y=clique_recall_mean_normalize_weighted, color =threshold_score)) +
  geom_point() 


ggplot(df, aes(x=clique_precision_mean_normalize, y=clique_recall_mean_normalize, color =precision_recall_product)) +
  geom_point()
ggplotly()

ggplotly()

ggplot(df, aes(x=clique_precision_mean_normalize_weighted, y=clique_recall_mean_normalize_weighted, color=threshold_score)) +
  geom_point() 


ggplot(df, aes(x=precision_recall_product, y=clique_precision_recall_product, color=threshold_score)) +
  geom_point() 
ggplotly()


df_high <- df %>% filter(threshold_score >= 0.78)

ggplot(df_high, aes(x=precision_recall_product, y=clique_precision_recall_product, color=threshold_score, size=numClust)) +
  geom_point() 
ggplotly()
```



Max product
Trying clique_precision_recall_product * precision_recall_product
```{r}

ggplot(df, aes(x=threshold_score, y=max_product, color=threshold_score, size=numClust)) +
  geom_point()

ggplotly()
df

df %>% group_by(threshold_score) %>% slice(which.max(max_product)) -> df_max
       


ggplot(df_max, aes(x=threshold_score, y=max_product, size=numClust)) +
  
  geom_point()

ggplotly()

#Made cytoscape for gross ii228 (ts 0.8), gross ii2054(ts 0.6), fine ii1310 (ts 0.05) 

ggplot(df_max, aes(x=precision_recall_product, y=clique_precision_recall_product, color=threshold_score, size=numClust)) +
  geom_point() 
ggplotly()



```


```{r}

df %>% filter(threshold_score==0.2) -> df02
ggplot(df02, aes(x=clique_precision_mean_normalize_weighted, y=clique_recall_mean_normalize_weighted, color=selected)) +
  geom_point(size=3)
ggplotly()



```
